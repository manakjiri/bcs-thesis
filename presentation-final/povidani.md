
Vážená komise, vážení hosté, dnes bych vám rád představil výsledky mé bakalářské práce.

(důrazně, pomalu) V tomto projektu jsem se zabýval návrhem komunikačního modulu s rozhraním LoRa a výrobou senzoru vlhkosti půdy postaveném na tomto modulu.

Cílem práce bylo navrhnout pilotní řešení problému cenově dostupného distribuovaného měření vlhkosti půdy. Po systému je požadována vysoká úroveň autonomie a dlouhodobá udržitelnost. Řešení též počítá s možností budoucího rozšíření sítě.

Jak jsem již zmínil, pro komunikaci mezi senzory a stanicí je použita LoRa. LoRa je způsob modulace, který je navržen pro vysoký dosah a dobrou penetraci prostředí při minimálním výkonu. Rozhodl jsem se nevyužívat komerčně dostupných poskytovatelů LoRaWAN sítě kvůli jejímu nízkému pokrytí v odlehlých oblastech a dlouhodobých nákladů s ní spojené.

Senzory vlhkosti mohou být nasazeny v místě bez infrastruktury a tedy je potřeba aby byly napájeny nezávislým zdrojem energie. Zde se jako jediná možnost nabízí solární energie. Tento požadavek se zásadě projeví v návrhu hardware. (pauza) V dnešní době je možnost vzdálené aktualizace firmware nedílnou součástí mnohých zařízení. Aktualizace by v tomto případě mohly přinést senzorům podporu meshingu, vylepšit jejich výdrž baterie a přesnost měření. Tato funkce není běžná pro uzly LoRa sítí, projekt je v tomto ohledu inovativní.

Senzor je postaven na plošném spoji, který integruje zmíněný komunikační modul LoRa a měřící obvody. (pauza) Vlhkost snímají 4 kapacitní plochy, které jsou zasunuty v zemi. (pauza) Mimo měřící obvody senzor obsahuje obvody ochrany baterie a dva teploměry. Jeden je umístěn na špičce senzoru v největší hloubce a druhý je těsně nad zemí.

Měřit vlhkost kapacitně je možné díky vysoké dielektrické konstantě vody, jak znázorněno stupnicí nahoře. Senzor měří kapacitu na základě časové konstanty RC obvodu, zde můžeme vidět zjednodušené schema zapojení. (pauza) Neznámý kapacitor C_X je nejprve vybíjen rezistorem R_DIS a poté připojen k referenci skrze rezistor R_CHG dokud napětí na svorkách kapacitoru C_X nedosáhne mezní hodnoty určené napěťovým děličem.

Aby byla elektronika ochráněna před povětrnostními vlivy a bylo možné připevnit solární panel a anténu, navrhl jsem a vytiskl třídílný kryt, který se nasune na horní část senzoru. Pro finální nasazení by senzor byl vyroben z 3.2 mm silného plošného spoje pro větší pevnost a horní část by byla vylita zalévacím tmelem.

Modul, který jsem v rámci této práce navrhl a vyrobil, slouží jako dobrá platforma pro široké spektrum dalších senzorů a smart aplikací. Modul je založen na STM32WLE, což je MCU, které kombinuje LoRa rádio s STM32L4 v jednom pouzdru. Tato volba byla ideální, jelikož dovolila velmi hustou míru integrace, výsledný modul zaujímá pouze 500 mm^2.

Pro ověření dosahu bezdrátové komunikace jsem provedl praktický experiment. Experiment měl zjistit maximální vzdálenost spojení a míru útlumu v závislosti na vzdálenosti antény od země. To je důležité, protože senzory a jejich antény jsou umístěny nízko u země. Proto jsem v experimentu zahrnul celkem tři uzly - Node 2 (modrá), jehož anténa je přibližně 20 cm nad zemí, Node 3 (červená) s anténou 90 cm nad zemí a Node 4 (zelená), což byla deska Nucleo od ST, která fungovala jako reference a byla umístěna přibližně uprostřed.

I při zachování takto malých rozměrů se mně podařilo dosáhnout stabilního přenosu na více než kilometr v členitém terénu, což předčilo má očekávání. Nahoře můžeme vidět graf popisující závislost úspěšnosti přenosu paketů na vzdálenosti. Dole vidíme vlevo vyneseny souřadnice míst, na kterých byly odečteny změřené hodnoty, vpravo je znázorněn reliéf krajiny a polohy antén zařízení. Při těchto parametrech přenosu nebylo možné dosáhnout limitu spojení. To bylo stabilní s minimálními ztrátami i při vzdálenosti 1.2 km.

Snížením spreading faktoru na 5 se zrychlil přenos paketu 9 násobně ale zároveň klesl dosah a tedy bylo možné pozorovat předpokládanou degradaci spojení. Nejníže položená Node 2 přestala odpovídat po té, co přijímač a vysílač ztratily přímou viditelnost. Zároveň můžeme pozorovat ztrátu spojení i pro Node 3, jediné Nucleo obstálo po celou dobu. Frontendy modulů nebyly nijak impedančně přizpůsobeny pro použité antény, takže lze očekávat horší dosah.

Dále jsem testoval možnosti vyrobeného senzoru vlhkosti půdy. Zde můžeme vidět graf měření vlhkosti půdy po dobu jednoho týdne. Zelená zóna byla jako jediná nad půdou, oranžová a fialová se nacházely v substrátu a poslední růžová byla spíše ve vrstvě keramsitu na dně květináče. V druhém dni měření jsme rostlinu zalili vodou, což je reflektováno nárustem relativní vlhkosti půdy na 80% v zónách, které byly v přímém kontaktu s půdou. Vlhkost v následujících dnech klesala, intuitivně horní vrstva vyschla nejdřív, zatímco hlubší vrstvy držely vlhkost déle. (pauza) Vidíme, že v grafu v období noci chybí data. To je způsobeno tím, že senzor byl napájen čistě solárním článkem a nezvládl nashromáždit dostatek energie přes den aby vydržel fungovat přes noc. Zvýšená spotřeba je způsobena tím, že frekvence vyčítání byla velmi vysoká proto abych dokázal lépe porozumět měřeným datům při prvních testech. Vysoká spotřeba byla také kvůli hardwarové chybě na modulu. V práci je zahrnuto více detailů a také jsem navrh ale nestihl již vyrobit další verzi modulu, která tuto chybu opravila.

Ukázka

Výstupem mé bakalářské práce byl tedy LoRa modul, což je jakási obecná platforma pro senzory a chytré zařízení. Schopnosti tohoto modulu jsem ukázal na problematice měření vlhkosti půdy. Funkčnost senzoru jsem vám zde demonstroval krátkou ukázkou a v mé práci je navíc podtržena aplikací, která využívá data z tohoto senzoru a na základě předpovědi počasí a dalších faktorů určuje kdy je potřeba zalévat rostliny. Posledním zásadním výsledkem, na který zde už nezbyl prostor, je veškerý firmware napsaný v jazyce Rust. Firmware je modulární a reflektuje rozdělení modulu a konečné aplikace. Budu rád za jakékoliv dotazy na toto téma. Všechny podklady k hardware, firmware a podpůrným aplikacím jsou dostupné veřejně na mém GitHubu.
