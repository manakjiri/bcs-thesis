% arara: pdflatex: { synctex: yes }
% arara: makeindex: { style: ctuthesis }
% arara: bibtex

% The class takes all the key=value arguments that \ctusetup does,
% and a couple more: draft and oneside
\documentclass[twoside]{ctuthesis}
\usepackage[toc]{appendix}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{svg}
\usepackage{placeins}
\usepackage[capposition=bottom]{floatrow}
\usepackage{listings, listings-rust}
\usepackage{multirow}
\usepackage{adjustbox}

\PassOptionsToPackage{hyphens}{url}
\usepackage[pdftex,
            pdfauthor={Jiří Maňák},
            pdftitle={Sensor network for Smart Agriculture}
			]{hyperref}

\ctusetup{
	preprint = \today,
	mainlanguage = english,
	titlelanguage = english,
	otherlanguages = {czech},
	title-czech = {Senzorová síť pro Smart Agriculture},
	title-english = {Sensor Network for Smart Agriculture},
%	subtitle-czech = {},
%	subtitle-english = {},
	doctype = B,
	faculty = F3,
	department-czech = {Katedra meření},
	department-english = {Department of Measurement},
	author = {Jiří Maňák},
	supervisor = {prof. Ing. Radislav Šmíd, Ph.D.},
	supervisor-address = {Praha, Technická 1902/2, místnost: A3-324},
%	supervisor-specialist = {},
%	fieldofstudy-english = {},
%	subfieldofstudy-english = {},
%	fieldofstudy-czech = {},
%	subfieldofstudy-czech = {},
	keywords-czech = {slovo, klíč},
	keywords-english = {word, key},
	day = 19,
	month = 5,
	year = 2024,
	specification-file = {sub/thesis-specification.pdf},
%	front-specification = true,
%	front-list-of-figures = false,
%	front-list-of-tables = false,
%	monochrome = true,
%	layout-short = true,
}


\ctuprocess

\addto\ctucaptionsczech{%
\def\supervisorname{prof. Ing. Radislav Šmíd, Ph.D.}%
\def\subfieldofstudyname{Kybernetika a Robotika}%
}

\ctutemplateset{maketitle twocolumn default}{
	\begin{twocolumnfrontmatterpage}
		\ctutemplate{twocolumn.thanks}
		\ctutemplate{twocolumn.declaration}
		\ctutemplate{twocolumn.abstract.in.titlelanguage}
		\ctutemplate{twocolumn.abstract.in.secondlanguage}
		\ctutemplate{twocolumn.tableofcontents}
		\ctutemplate{twocolumn.listoffigures}
	\end{twocolumnfrontmatterpage}
}

\lstset{language=Rust, style=boxed}

\newcommand{\code}[1]{\lstinline{#1}}
\newcommand{\link}[2]{\href{#1}{#2}\footnote{#1}}

\setlength{\parskip}{1.5ex plus 0.2ex minus 0.1ex}

% Abstract in Czech
\begin{abstract-czech}
Tato bakalářská práce se zabývá vývojem bezdrátového senzoru pro měření vlhkosti půdy, který je užitečný pro efektivní hospodaření s vodními zdroji v zemědělství, zahradnictví a domácnostech. Výsledkem práce jsou dva hardwarové komponenty, univerzální modul s podporou LoRa rozhranní a senzor vlhkosti půdy, založený na kapacitním měření objemového obsahu vody. Modul, postavený na čipu STM32WLE, obsahuje integrovanou nevolatilní paměť pro záznam dat a aktualizace firmwaru, je kompaktní, má nízkou spotřebu a univerzální podporu I/O. Firmware modulu je implementován v programovacím jazyce Rust. Experimentem byla oveřena stabilní komunikace modulu na vzdálenosti přesahující jeden kilometr.
\end{abstract-czech}

% Abstract in English
\begin{abstract-english}
This thesis examines the development of a wireless sensor for soil moisture sensing, crucial for efficient water resource management in agriculture, horticulture, and domestic settings. Outcome of the work are two hardware components, a general purpose LoRa module and the soil moisture sensor, based on capacitive volumetric water content measurement. The module, built on the STM32WLE System on a Chip, features integrated non-volatile memory for data logging and firmware updates, compact size, low power consumption, and versatile I/O support, its firmware is implemented in the Rust language. Field tests confirmed the module's stable communication over distances exceeding one kilometer, demonstrating its effectiveness and potential for broader applications.
\end{abstract-english}

% Acknowledgements / Podekovani
\begin{thanks}
I would like to express gratitude to those who helped and supported me during the creation of this thesis.

First and foremost, I would like to thank my supervisor, Prof.~Radislav~Šmíd, for his insights, positive attitude, ideas and the material support.

Also my partner, Bc.~Diana~Varšíková, for her support, counsel of the visualizations and the final review pass.

Lastly, huge thanks goes to Ing.~Tomáš~Kořínek and Ing.~Jan~Spáčil from the department of electromagnetic field for their willingness, provided access to the instruments and overall great company.
\end{thanks}

% Declaration / Prohlaseni
\begin{declaration}
\noindent I hereby declare that I have independently authored the submitted thesis and have cited all the sources used.
\vspace{1em}
\hrule
\noindent Prohlašuji, že jsem předloženou práci vypracoval samostatně, a že jsem uvedl veškerou použitou literaturu.
\begin{flushright}
V Praze \ctufield{day}.~května~\ctufield{year}
\end{flushright}
\end{declaration}


\begin{document}

\maketitle

\ctutemplate{specification.as.chapter}

\chapter{\label{chapter:introduction}Introduction}
\input{sub/1_intro.tex}
\chapter{\label{chapter:prior}Prior Art}
\input{sub/2_prior.tex}
\chapter{\label{chapter:architecture}System Architecture}
\input{sub/3_architecture.tex}
\chapter{\label{chapter:results}Results}
\input{sub/4a_results.tex}
\input{sub/4b_experiments.tex}
\chapter{Conclusions}
\input{sub/5_conclusion.tex}
\printindex

\begin{appendices}
\chapter{\label{chapter:rust}Using the Rust Programming Language for Embedded Applications}
\input{sub/a_rust.tex}
\chapter{\label{chapter:module01-files}Module v0.1 Design Files}
\input{sub/b_module01.tex}
\chapter{\label{chapter:sensor-files}Soil Moisture Sensor Board Design Files}
\input{sub/d_sensor01.tex}
\chapter{\label{chapter:more-range-test}Additional Data from the Range Test}
\input{sub/e_range_test.tex}
\end{appendices}

\bibliographystyle{plainurl}
\bibliography{main.bib}

\end{document}